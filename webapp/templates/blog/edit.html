{% extends "blog/base.html" %}
{% block title %}编辑{% endblock %}
{% block body %}
    <form method="post" action="{{ url_for('.edit',id=post.id) }}"  class="uk-form-stacked">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.title.label() }}
            {{ form.title(class="form-control",value=post.title) }}
        </div>
        <div class="form-group">
            {{ form.cover.label() }}
            {{ form.cover(class="form-control") }}
            {% if form.cover.errors %}
                {% for e in form.cover.errors %}
                    <small class="form-text text-muted">{{ e }}</small>
                {% endfor %}
            {% endif %}
        </div>

         <div class="form-group">
            {{ form.tags.label() }}
            {{ form.tags(class="form-control") }}
            {% if form.tags.errors %}
                {% for e in form.tags.errors %}
                    <small class="form-text text-muted">{{ e }}</small>
                {% endfor %}
            {% endif %}
        </div>

        <div class="card">
            <div class="card-body">
                <div id="photo_box" style="max-height: 400px;overflow-y: auto">
                    <div class="form-group">
                        <label>图片1</label>
                        <input class="form-control" name="photos-0"/>
                    </div>
                </div>
                {% if form.photos.errors %}
                    {% for e in form.photos.errors %}
                        <small class="form-text text-muted">{{ e }}</small>
                    {% endfor %}
                {% endif %}
                <a href="#" class="btn btn-primary" onclick="addImg()" >添加图片</a>
          </div>
        </div>


        <div class="form-group">
            {{ form.text.label() }}
            {{ form.text(id='editor',class="form-control",rows=5) }}
            {% if form.text.errors %}
                {% for e in form.text.errors %}
                    <small class="form-text text-muted">{{ e }}</small>
                {% endfor %}
            {% endif %}
        </div>
        <input class="btn btn-primary" type="submit" value="发布" >
    </form>
{% endblock %}
{% block js %}
    <script src="https://cdn.ckeditor.com/ckeditor5/1.0.0-alpha.1/classic/ckeditor.js"></script>
    <script>
        ClassicEditor.create( document.querySelector( '#editor' ) )

        function addImg(){
            var box=document.getElementById('photo_box');
            var list=box.querySelectorAll('.form-group');
            var len=list.length;
            var index=len;
            var item=`<div class="form-group">
                    <label>图片${index+1}</label>
                    <input class="form-control" name="photos-${index}" />
                    </div>`
            var div=document.createElement("div");
            div.innerHTML=item;
            box.appendChild(div)
        }
    </script>
{% endblock %}